"0",""
"0","df_summary <- coronavirus %>% "
"0","  # dplyr::filter(Country.Region != ""Others"") %>%"
"0","  dplyr::group_by(Country.Region, type) %>%"
"0","  dplyr::summarise(total_cases = sum(cases)) %>%"
"0","  tidyr::pivot_wider(names_from = type, values_from = total_cases) %>%"
"0","  dplyr::arrange(- confirmed) %>%"
"0","  dplyr::filter(confirmed >= 25) %>%"
"0","  dplyr::select(country = Country.Region, confirmed, death, recovered) %>%"
"0","  dplyr::mutate(death_rate = death / confirmed*100) %>% "
"0","  ungroup()%>% "
"0","  dplyr::mutate(country = factor(country, levels = country))"
"0",""
"0","plotly::plot_ly(data = df[1:30, ], "
"0","                x = ~ country, "
"0","                y = ~ unrecovered, "
"0","                #text =  ~ confirmed, "
"0","                #textposition = 'auto',"
"0","                type = ""bar"", "
"0","                name = ""Заболевшие"","
"0","                marker = list(color = active_color)) %>%"
"0","  plotly::add_trace(y = ~ recovered,"
"0","                    # text =  ~ recovered,"
"0","                    # textposition = 'auto',"
"0","                    name = ""Выздоровевшие"","
"0","                    marker = list(color = recovered_color)) %>%"
"0","  plotly::add_trace(y = ~ death, "
"0","                    # text =  ~ death, "
"0","                    # textposition = 'auto',"
"0","                    name = ""Смерти"","
"0","                    marker = list(color = death_color)) %>%"
"0","  plotly::layout(barmode = 'stack',"
"0","                 yaxis = list(title = ""Все наблюдения (Log шкала)"","
"0","                              type = ""log""),"
"0","                 xaxis = list(title = """"),"
"0","                 hovermode = ""compare"","
"0","                 margin =  list("
"0","                   # l = 60,"
"0","                   # r = 40,"
"0","                   b = 10,"
"0","                   t = 10,"
"0","                   pad = 2"
"0","                 ))"
